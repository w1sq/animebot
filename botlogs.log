ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-45' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'favorites'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 159, in inline_handler
    favorites = db_sess.query(Users).get(user_id).favorites
AttributeError: 'NoneType' object has no attribute 'favorites'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-48' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'favorites'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 159, in inline_handler
    favorites = db_sess.query(Users).get(user_id).favorites
AttributeError: 'NoneType' object has no attribute 'favorites'
WARNING:serializer:Can not serialize type:Users
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-61' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'dict' object has no attribute 'to_message'")>
Traceback (most recent call last):
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 117, in send_titles
    message_text=i.to_message(),parse_mode='html'
AttributeError: 'Anime' object has no attribute 'to_message'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 160, in inline_handler
    await send_titles(titles = favorites,query=query,cache_time=1)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 131, in send_titles
    message_text=i.to_dict().to_message(),parse_mode='html'
AttributeError: 'dict' object has no attribute 'to_message'
INFO:aiogram.dispatcher.dispatcher:Start polling.
WARNING:serializer:Can not serialize type:Users
WARNING:serializer:Can not serialize type:Users
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-67' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=BadRequest('Can\'t parse inline query result: field "message_text" must be of type string')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 160, in inline_handler
    await send_titles(titles = favorites,query=query,cache_time=1)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 147, in send_titles
    await query.answer(
  File "C:\python\lib\site-packages\aiogram\types\inline_query.py", line 61, in answer
    return await self.bot.answer_inline_query(self.id,
  File "C:\python\lib\site-packages\aiogram\bot\bot.py", line 2798, in answer_inline_query
    return await self.request(api.Methods.ANSWER_INLINE_QUERY, payload)
  File "C:\python\lib\site-packages\aiogram\bot\base.py", line 208, in request
    return await api.make_request(self.session, self.server, self.__token, method, data, files,
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 140, in make_request
    return check_result(method, response.content_type, response.status, await response.text())
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 115, in check_result
    exceptions.BadRequest.detect(description)
  File "C:\python\lib\site-packages\aiogram\utils\exceptions.py", line 141, in detect
    raise cls(description)
aiogram.utils.exceptions.BadRequest: Can't parse inline query result: field "message_text" must be of type string
INFO:aiogram.dispatcher.dispatcher:Start polling.
WARNING:serializer:Can not serialize type:Users
WARNING:serializer:Can not serialize type:Users
WARNING:serializer:Can not serialize type:Users
WARNING:serializer:Can not serialize type:Users
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=BadRequest('Can\'t parse inline query result: field "message_text" must be of type string')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 161, in inline_handler
    await send_titles(titles = favorites,query=query,cache_time=1)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 148, in send_titles
    await query.answer(
  File "C:\python\lib\site-packages\aiogram\types\inline_query.py", line 61, in answer
    return await self.bot.answer_inline_query(self.id,
  File "C:\python\lib\site-packages\aiogram\bot\bot.py", line 2798, in answer_inline_query
    return await self.request(api.Methods.ANSWER_INLINE_QUERY, payload)
  File "C:\python\lib\site-packages\aiogram\bot\base.py", line 208, in request
    return await api.make_request(self.session, self.server, self.__token, method, data, files,
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 140, in make_request
    return check_result(method, response.content_type, response.status, await response.text())
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 115, in check_result
    exceptions.BadRequest.detect(description)
  File "C:\python\lib\site-packages\aiogram\utils\exceptions.py", line 141, in detect
    raise cls(description)
aiogram.utils.exceptions.BadRequest: Can't parse inline query result: field "message_text" must be of type string
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-20' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-24' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-28' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-27' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=IndexError('list index out of range')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 381, in ans
    id = call.data.split('_')[3]
IndexError: list index out of range
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-31' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=IndexError('list index out of range')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 381, in ans
    id = call.data.split('_')[3]
IndexError: list index out of range
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-35' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=IndexError('list index out of range')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 381, in ans
    id = call.data.split('_')[3]
IndexError: list index out of range
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-39' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=IndexError('list index out of range')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 381, in ans
    id = call.data.split('_')[3]
IndexError: list index out of range
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-9' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-13' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:aiogram.dispatcher.dispatcher:Cause exception while getting updates.
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 383, in start_polling
    updates = await self.bot.get_updates(
  File "C:\python\lib\site-packages\aiogram\bot\bot.py", line 97, in get_updates
    result = await self.request(api.Methods.GET_UPDATES, payload)
  File "C:\python\lib\site-packages\aiogram\bot\base.py", line 208, in request
    return await api.make_request(self.session, self.server, self.__token, method, data, files,
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 140, in make_request
    return check_result(method, response.content_type, response.status, await response.text())
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 128, in check_result
    raise exceptions.TelegramAPIError(description)
aiogram.utils.exceptions.TelegramAPIError: Bad Gateway
ERROR:aiogram.dispatcher.dispatcher:Cause exception while getting updates.
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 383, in start_polling
    updates = await self.bot.get_updates(
  File "C:\python\lib\site-packages\aiogram\bot\bot.py", line 97, in get_updates
    result = await self.request(api.Methods.GET_UPDATES, payload)
  File "C:\python\lib\site-packages\aiogram\bot\base.py", line 208, in request
    return await api.make_request(self.session, self.server, self.__token, method, data, files,
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 140, in make_request
    return check_result(method, response.content_type, response.status, await response.text())
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 128, in check_result
    raise exceptions.TelegramAPIError(description)
aiogram.utils.exceptions.TelegramAPIError: Bad Gateway
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-178' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 364, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-9' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 364, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-13' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 364, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-33' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 364, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-74' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 364, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-9' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-13' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-17' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-9' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-13' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-36' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-40' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 365, in add_favorites
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id, reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u274c Убрать из моего списка аниме',callback_data=f'remove_from_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-60' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=UnboundLocalError("local variable 'titles' referenced before assignment")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 243, in inline_handler
    await send_titles(titles,query)
UnboundLocalError: local variable 'titles' referenced before assignment
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id,reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u2705 Добавить в мой список аниме',callback_data=f'add_to_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-22' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'message_id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await bot.edit_message_reply_markup(user_id, message_id=call.message.message_id,reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{id}')).add(InlineKeyboardButton(text='\u2705 Добавить в мой список аниме',callback_data=f'add_to_favorites_{id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')))
AttributeError: 'NoneType' object has no attribute 'message_id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 338, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=TypeError("'NoneType' object cannot be interpreted as an integer")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 338, in remove_from_favorites
    user.favorites.pop(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1243, in pop
    item = fn(self, index)
TypeError: 'NoneType' object cannot be interpreted as an integer
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-22' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 338, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
ERROR:aiogram.dispatcher.dispatcher:Cause exception while getting updates.
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 383, in start_polling
    updates = await self.bot.get_updates(
  File "C:\python\lib\site-packages\aiogram\bot\bot.py", line 97, in get_updates
    result = await self.request(api.Methods.GET_UPDATES, payload)
  File "C:\python\lib\site-packages\aiogram\bot\base.py", line 208, in request
    return await api.make_request(self.session, self.server, self.__token, method, data, files,
  File "C:\python\lib\site-packages\aiogram\bot\api.py", line 139, in make_request
    async with session.post(url, data=req, **kwargs) as response:
  File "C:\python\lib\site-packages\aiohttp\client.py", line 1117, in __aenter__
    self._resp = await self._coro
  File "C:\python\lib\site-packages\aiohttp\client.py", line 544, in _request
    await resp.start(conn)
  File "C:\python\lib\site-packages\aiohttp\client_reqrep.py", line 905, in start
    self._continue = None
  File "C:\python\lib\site-packages\aiohttp\helpers.py", line 656, in __exit__
    raise asyncio.TimeoutError from None
asyncio.exceptions.TimeoutError
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-175' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 382, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 338, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 383, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 339, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 384, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 340, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 385, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 341, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=ValueError('list.remove(x): x not in list')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 386, in ans
    await remove_from_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 341, in remove_from_favorites
    user.favorites.remove(anime)
  File "C:\python\lib\site-packages\sqlalchemy\orm\collections.py", line 1126, in remove
    fn(self, value)
ValueError: list.remove(x): x not in list
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-15' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'Title' object has no attribute 'id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 213, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[7:],types='anime-serial')
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 101, in search
    titles = self._group_by_name(all_titles,phraze)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 138, in _group_by_name
    anime = db_sess.query(Anime).filter(Anime.kodik_id == title.id).first()
AttributeError: 'Title' object has no attribute 'id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-23' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'Title' object has no attribute 'id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 231, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[12:],types='anime-serial',sort='shikimori_rating')
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 101, in search
    titles = self._group_by_name(all_titles,phraze)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 138, in _group_by_name
    anime = db_sess.query(Anime).filter(Anime.kodik_id == title.id).first()
AttributeError: 'Title' object has no attribute 'id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-28' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=UnboundLocalError("local variable 'titles' referenced before assignment")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 243, in inline_handler
    await send_titles(titles,query)
UnboundLocalError: local variable 'titles' referenced before assignment
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-39' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'Title' object has no attribute 'id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 178, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[6:],types='anime')
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 101, in search
    titles = self._group_by_name(all_titles,phraze)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 138, in _group_by_name
    anime = db_sess.query(Anime).filter(Anime.kodik_id == title.id).first()
AttributeError: 'Title' object has no attribute 'id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-44' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'Title' object has no attribute 'id'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 184, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[9:],types='anime',sort='kinopoisk_rating')
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 101, in search
    titles = self._group_by_name(all_titles,phraze)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 138, in _group_by_name
    anime = db_sess.query(Anime).filter(Anime.kodik_id == title.id).first()
AttributeError: 'Title' object has no attribute 'id'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-49' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=UnboundLocalError("local variable 'titles' referenced before assignment")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 208, in inline_handler
    await send_titles(titles,query)
UnboundLocalError: local variable 'titles' referenced before assignment
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-5' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=UnboundLocalError("local variable 'titles' referenced before assignment")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 208, in inline_handler
    await send_titles(titles,query)
UnboundLocalError: local variable 'titles' referenced before assignment
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-8' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=UnboundLocalError("local variable 'titles' referenced before assignment")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 208, in inline_handler
    await send_titles(titles,query)
UnboundLocalError: local variable 'titles' referenced before assignment
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-11' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'Title' object has no attribute 'id'")>
Traceback (most recent call last):
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 115, in send_titles
    reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{i.id}')).add(InlineKeyboardButton(text=text,callback_data=f'{callback_data}#{i.id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')),
AttributeError: 'Title' object has no attribute 'id'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 179, in inline_handler
    await send_titles(titles,query)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 129, in send_titles
    reply_markup=InlineKeyboardMarkup(resize_keyboard=True).add(InlineKeyboardButton(text='\U0001f37f Смотреть',url=f'http://127.0.0.1:5000/id/{i.id}')).add(InlineKeyboardButton(text=text,callback_data=f'{callback_data}#{i.id}')).add(InlineKeyboardButton(text='\U0001f50e Поиск по названию',callback_data='name_search_anime')),
AttributeError: 'Title' object has no attribute 'id'
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-25' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=TypeError("search() missing 1 required positional argument: 'types'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 172, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[4:])
TypeError: search() missing 1 required positional argument: 'types'
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-22' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=TypeError("search() missing 1 required positional argument: 'types'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 172, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[4:])
TypeError: search() missing 1 required positional argument: 'types'
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-12' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=NotFoundError('No anime with this name')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 172, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[4:])
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 98, in search
    raise self.NotFoundError('No anime with this name')
searcher.Searcher.NotFoundError: No anime with this name
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-17' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=NotFoundError('No anime with this name')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 172, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[4:])
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 98, in search
    raise self.NotFoundError('No anime with this name')
searcher.Searcher.NotFoundError: No anime with this name
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-20' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'favorites'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 286, in process_update
    return await self.callback_query_handlers.notify(update.callback_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 393, in ans
    await add_to_favorites(user_id,id)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 335, in add_to_favorites
    user.favorites.append(anime)
AttributeError: 'NoneType' object has no attribute 'favorites'
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-29' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=AttributeError("'NoneType' object has no attribute 'favorites'")>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 159, in inline_handler
    favorites = db_sess.query(Users).get(user_id).favorites
AttributeError: 'NoneType' object has no attribute 'favorites'
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
ERROR:asyncio:Task exception was never retrieved
future: <Task finished name='Task-46' coro=<Dispatcher._process_polling_updates() done, defined at C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py:409> exception=NotFoundError('No anime with this name')>
Traceback (most recent call last):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 417, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 238, in process_updates
    return await asyncio.gather(*tasks)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\python\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 276, in process_update
    return await self.inline_query_handlers.notify(update.inline_query)
  File "C:\python\lib\site-packages\aiogram\dispatcher\handler.py", line 116, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\bot.py", line 219, in inline_handler
    titles = await searcher.search(str(query.query).strip().lower()[7:],types='anime-serial')
  File "c:\Users\Artem\OneDrive\all_python\freelance-animebot\bot\searcher.py", line 98, in search
    raise self.NotFoundError('No anime with this name')
searcher.Searcher.NotFoundError: No anime with this name
INFO:aiogram.dispatcher.dispatcher:Start polling.
INFO:aiogram.dispatcher.dispatcher:Start polling.
